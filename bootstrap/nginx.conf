# Port 8080: iPXE handoff scripts and Ubuntu images
server {
    listen 8080;
    server_name 108.181.38.67;

    root /var/www/html;
    index index.html;

    location / {
        try_files $uri $uri/ =404;
    }

    # Serve .ipxe files as plain text
    location ~ \.ipxe$ {
        add_header Content-Type text/plain;
    }
}

# Port 8081: OS images and Harvester PXE files
server {
    listen 8081;
    server_name 108.181.38.67;

    # Ubuntu images (noble-bnx2.raw.gz, etc)
    root /var/www;

    location / {
        autoindex on;
        try_files $uri $uri/ =404;
    }

    # Harvester PXE boot files
    location /harvester/ {
        alias /var/www/harvester/;
        autoindex on;
    }

    # Serve .ipxe files as plain text
    location ~ \.ipxe$ {
        add_header Content-Type text/plain;
    }

    # Serve .yaml files as plain text
    location ~ \.yaml$ {
        add_header Content-Type text/plain;
    }
}
